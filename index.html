<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Please Enqueue Responsibly - Ethan Clevenger</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css">
		<link href='https://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>Please Enqueue Responsibly</h1>
					<h2>Ethan Clevenger</h2>
				</section>
				<section>
					<h2>A bit about me</h2>
					<table>
						<tr>
							<td>
								<a href="http://webspecdesign.com"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 153.62 22.795" style="enable-background:new 0 0 153.62 22.795;" xml:space="preserve">
									<style type="text/css">
									* {
									fill:white;
									}
									</style>
									<polygon style="" class="webspec-fill" points="21.723,5.368 24.767,5.368 26.612,15.323 26.652,15.323 28.89,5.368 32.384,5.368
									34.505,15.323 34.544,15.323 36.312,5.368 39.218,5.368 36.077,19.546 32.796,19.546 30.579,9.177 30.539,9.177 28.084,19.546
									24.865,19.546 "></polygon>
									<polygon style="" class="webspec-fill" points="39.847,19.546 39.847,5.368 47.583,5.368 47.583,7.546 42.813,7.546 42.813,11.044
									47.21,11.044 47.21,13.224 42.813,13.224 42.813,17.366 47.742,17.366 47.742,19.546 "></polygon>
									<g>
									<defs>
									<rect id="SVGID_1_" width="153.62" height="22.795"></rect>
									</defs>
									<clipPath id="SVGID_2_">
									<use xlink:href="#SVGID_1_" style="overflow:visible;"></use>
									</clipPath>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M49.116,19.546V5.368h5.263c2.259,0,4.123,0.646,4.123,3.672
									c0,1.631-0.805,2.806-2.415,3.123V12.2c2.1,0.297,2.651,1.65,2.651,3.594c0,3.592-3.122,3.752-4.379,3.752H49.116z M52.082,11.161
									h1.982c0.649,0,1.552-0.434,1.552-1.807c0-1.041-0.706-1.808-1.708-1.808h-1.826V11.161z M52.082,17.366h1.649
									c0.628,0,2.042-0.02,2.042-2.006c0-1.254-0.472-2.021-1.964-2.021h-1.727V17.366z"></path>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M64.335,19.78c-3.672,0-4.361-2.16-4.203-4.615h2.965
									c0,1.357,0.058,2.494,1.687,2.494c1.002,0,1.494-0.648,1.494-1.608c0-2.556-5.969-2.712-5.969-6.931
									c0-2.219,1.06-3.988,4.673-3.988c2.885,0,4.321,1.296,4.124,4.263h-2.888c0-1.064-0.176-2.142-1.374-2.142
									c-0.961,0-1.53,0.531-1.53,1.509c0,2.692,5.968,2.457,5.968,6.914C69.282,19.351,66.592,19.78,64.335,19.78"></path>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M70.833,5.368h5.343c2.709,0,3.769,1.649,3.769,4.243
									c0,1.609-0.471,4.162-3.945,4.162h-2.2v5.773h-2.966V5.368z M73.799,11.591h1.649c0.883,0,1.493-0.961,1.493-1.902
									c0-1.161-0.315-2.143-1.649-2.143h-1.493V11.591z"></path>
									<polygon style="clip-path:url(#SVGID_2_);" class="webspec-fill" points="81.144,19.546 81.144,5.368 88.88,5.368 88.88,7.546
									84.109,7.546 84.109,11.044 88.506,11.044 88.506,13.224 84.109,13.224 84.109,17.366 89.038,17.366 89.038,19.546 	"></polygon>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M90.236,12.456c0-3.752,0-7.322,4.888-7.322
									c3.024,0,4.243,1.668,4.122,4.711h-2.902c0-1.885-0.336-2.592-1.22-2.592c-1.668,0-1.883,1.57-1.883,5.203s0.215,5.203,1.883,5.203
									c1.375,0,1.316-1.768,1.356-2.885h2.926c0,3.789-1.512,5.006-4.282,5.006C90.236,19.78,90.236,16.167,90.236,12.456"></path>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M102.332,5.368h3.75c3.964,0,4.456,2.316,4.456,7.146
									c0,4.711-0.687,7.031-4.967,7.031h-3.239V5.368z M103.587,18.485h1.529c3.791,0,4.164-1.021,4.164-6.814
									c0-4.065-0.549-5.243-4.046-5.243h-1.647V18.485z"></path>
									<polygon style="clip-path:url(#SVGID_2_);" class="webspec-fill" points="119.177,5.368 119.177,6.429 114.013,6.429 114.013,11.727
									118.942,11.727 118.942,12.79 114.013,12.79 114.013,18.485 119.314,18.485 119.314,19.546 112.758,19.546 112.758,5.368 	"></polygon>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M126.935,8.962c-0.041-1.748-0.472-2.811-2.396-2.811
									c-1.531,0-2.495,0.532-2.495,2.202c0,2.101,1.062,2.16,2.673,3.318c1.747,1.256,3.535,1.631,3.535,4.379
									c0,2.533-1.299,3.77-3.771,3.77c-2.77,0-4.007-1.494-3.89-4.262h1.297c0,1.574,0.117,3.201,2.65,3.201
									c1.647,0,2.453-0.885,2.453-2.512c0-1.924-1.275-2.475-3.316-3.732c-2.75-1.688-2.867-2.535-2.886-3.948
									c-0.021-2.453,1.529-3.472,3.848-3.472c2.946,0,3.573,1.824,3.573,3.867H126.935z"></path>
									<rect x="130.389" y="5.37" style="clip-path:url(#SVGID_2_);" class="webspec-fill" width="1.259" height="14.176"></rect>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M140.816,13.204h-2.867v-1.062h4.125v7.089
									c-1.258,0.393-2.574,0.588-3.908,0.588c-4.613,0-4.281-4.613-4.281-7.363s-0.332-7.361,4.281-7.361
									c2.711,0,4.104,1.156,4.045,3.906h-1.257c0-1.867-0.806-2.85-2.788-2.85c-3.062,0-3.022,2.731-3.022,6.305
									c0,3.574-0.04,6.303,3.022,6.303c1.079,0,1.982-0.156,2.65-0.409V13.204z"></path>
									<polygon style="clip-path:url(#SVGID_2_);" class="webspec-fill" points="144.646,19.546 144.646,5.368 146.57,5.368 152.324,17.817
									152.365,17.776 152.365,5.368 153.62,5.368 153.62,19.546 151.714,19.546 145.943,6.96 145.902,6.997 145.902,19.546 	"></polygon>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M1.753,11.272c-1.521,2.977,1.091,7.685,6.068,11.521h7.182V10.04
									C8.723,7.88,3.318,8.208,1.753,11.272"></path>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M0,16.088v6.707h6.58C3.663,20.702,1.396,18.312,0,16.088"></path>
									<path style="clip-path:url(#SVGID_2_);" class="webspec-fill" d="M15.003,9.277V0H0v8.424C2.674,6.397,8.49,6.752,15.003,9.277"></path>
									</g>
								</svg></a>
							</td>
							<td>
								<a href="http://findingtheforest.com"><img style="width:200px" src="img/ftf.png"></a>
							</td>
						</tr>
					</table>
					<span style="text-align:center;font-size:50px;font-family:Lobster"><a href="http://beerpilgrimage.com" style="color:white">beerPilgrimage</a></span>
					<table style="margin-top:2em">
						<tr>
							<td>
								<i class="fa fa-bookmark"></i>
							</td>
							<td>
								<a style="color:white" href="http://ethanclevenger.com">ethanclevenger.com</a>
							</td>
						</tr>
						<tr>
							<td>
								<i class="fa fa-github"></i>
							</td>
							<td>
								<a style="color:white" href="https://github.com/ethanclevenger91">ethanclevenger91</a>
							</td>
						</tr>
						<tr>
							<td>
								<i class="fa fa-twitter"></i>
							</td>
							<td>
								<a style="color:white" href="http://twitter.com/ethanclevenger">@ethanclevenger</a>
							</td>
						</tr>
						<tr>
							<td>
								<i class="fa fa-wordpress"></i>
							</td>
							<td>
								<a style="color:white" href="https://profiles.wordpress.org/eclev91">eclev91</a>
							</td>
						</tr>
					</table>
					<aside class="notes">Hey, I’m Ethan Clevenger. I’m a frontend/backend web developer, designer, what-have-you from Des Moines, IA. I work for a company up there called Webspec Design where I do a lot of WordPress work, but also some custom stuff working with MVCs like Laravel. I run a website called BeerPilgrimage, I write for an new online publication called Finding the Forest, and I also do some freelance, I have a couple open-source libraries and contribute to others, so on and so forth. I’ve got one WordPress plugin out there, Picture Element Thumbnails, that does responsive images for WordPress. You might be saying “Well isn’t that built into core now?” to which I would say that the conversation on the difference between responsive images and art-directed responsive images is a topic for another talk, because today I’m here to talk about scripts, styles, requests and performance.
					</aside>
				</section>
				<section>
					<h1>"Beginner"</h1>
						<ul>
							<li>Internet - self-taught, chasm of best-practices</li>
							<li>Talking about "basics" at WordCamp</li>
							<li>Everyone's a beginner at something</li>
							<li>Consider the requirements of your project</li>
							<li>Don't do something because I said so</li>
						</ul>
					<aside class="notes">
						<p>Agh, I don't want to say don't use the word beginner, because there is such a thing, but see, the web is a funny industry in that, and this might be a lot of you, it’s very easy to teach yourself, start doing stuff for clients, never have a code review and do things totally “wrong” but be wildly successful doing it. So you end up with practices that someone like me might take for granted that you’ve never even thought about and, similarly, things you take for granted that I’ve never thought of, unlike many other industries where you pretty much have to have a formalized education.</p>

						<p>So we come to WordCamp and we're like "Ah, the pinnacle of WordPress!" But we're having conversations, which we totally should, about “basic” things like wp_enqueue_scripts, which many people may be super familiar with and a lot of others may have never heard of. Conversely, I doubt they have presentations about “basic” things, like giving booster shots, at pediatrics conventions. The long and short of that whole spiel is that this talk is labeled intermediate but it's really for everybody and you can take it as far as you want. We're all beginners at something and you should never feel bad for not knowing something. Don't let someone say "Oh you don't know that, are you even a web developer?"</p>

						<p>So today I’m going to chat with you about scripts and styles and give you lots of advice, but you should remember a couple things. The first is that I’m working on my site and you’re working on yours, so take everything I say and then use your best judgement. You know your projects better than I do. The second thing to remember is that “because some guy at WordCamp said so” is a terrible reason to do anything. Especially for people who do client work, you should always be asking why you’re doing something, so I’m actually going to start off talking about why this stuff is important and make a pitch for the relevence of my talk today.</p>
				</section>
				<section>
					<h2>Your site should be fast.</h2>
					<ul>
						<li>Bounce at 4-ish seconds, at mercy of computer between 1 and 10</li>
						<li>Speed analyzers red</li>
						<li>All content loaded - not TTFB</li>
					</ul>
					<img src="img/gif-line.gif" style="margin-top:1em;">
					<span style="font-style:italic;font-size:22px;margin-top:1em;display:block;">*https://www.nngroup.com/articles/website-response-times/</span>
					<aside class="notes">
						<p>Your site should be fast. This isn't new information to any of you I'm sure - there are piles of articles out there on the web that say bounce rates skyrocket after four-ish seconds. According to Nielsen Norman, your users not only bounce, but start to feel "at the mercy of the computer" beginning after just one second, and bounce definitely after 10 seconds.</p>

						<p>And I am talking about users here, so like your site is loaded fast. Not just time-to-first-byte or stuff starts popping in. If ads are still loading, your site isn't done as far as I'm concerned, especially if they're bumping content around and marring up the scroll. Sorry.</p>

						<p>If you’ve ever submitted a slow site to Google’s page speed analyzer, you’ll notice it gives you big red boxes as feedback, and that’s pretty much the same for any service that does page speed analytics. That’s because slow is, generally, bad.</p>
					</aside>
				</section>
				<section>
					<h1>Requests</h1>
					<ul>
						<li>Any time a site gets a resource from a server</li>
						<li>FIFO, HOL-blocking</li>
						<li>Images are a lost cause</li>
					</ul>
					<img style="margin-top:1em" src="img/slowalkers.gif">
					<aside class="notes">
						<p>So we're probably all on board with that. Here's the less-well-known part - why is your site slow? There can be lots of reasons, but generally, it has to do with requests - that is, any time your site gets a resource from a server.</p>

						<p>Requests to any one server, using HTTP/1.1, are FIFO - first-in-first-out. Results must be returned in the order they were received. Sometimes this results in head-of-line blocking, and even when it doesn’t, there’s still a line. This means, generally, that more requests are more detrimental to the load speed of your website than big requests. Not that this totally excuses you for having 10MB images on your site, as that’s bad for a host of other reasons, not limited to site speed.</p>

						<p>And if you’ve been on the internet lately, you might have noticed that images are in vogue. They’re engaging, they tell stories - people will even sell you pretty but generic ones to stuff into your website.</p>

						<p>Unfortunately, these are the requests we have the least ability to optimize - they tie your hands. As a WordPress theme developer, you’re probably creating spaces for the end user to upload images, and they can drop as many as they want into the WYSIWYG. Every one of those is a single request - you can’t generate fancy spritesheets and have totally arbitrary images.</p>

						<p>So if images are out there trashing our websites, we can at least cut our losses by making our CSS and JS efficient. If you aren't sold on the idea of making a fast website and doing it by getting smart with our requests, your probably not going to get much from this talk.</p>

						<p>For everyone else, I’m going to apply this specifically to WordPress. The first thing we can do is start using these magic functions `wp_enqueue_script` and `wp_enqueue_style`.</p>
				</section>
				<section>
					<h2>wp_enqueue_script, wp_enqueue_style</h2>
					<ul>
						<li>Alert WordPress to scripts and styles your site will require</li>
						<li>Dependency management</li>
					</ul>
					<aside class="notes">
						<p>How many of you are already familiar with these functions?</p>

						<p>Awesome, I had hoped so/this talk might go from 0 to advanced real quick then. Alternatively, how many of you are currently putting script and link tags right into your theme template files?</p>

						<p>I feel like some of you raised your hands for both. I thought those were mutually exclusive…</p>

						<p>So what do `wp_enqueue_script` and `wp_enqueue_style` do? These are functions that alert WordPress to the existence of scripts and styles that the site is going to require, where they should be dropped in, what version if the file it is and if it depends on any other scripts or styles. Then, when you call `wp_head()` in your header or `wp_footer()` in your footer, it’s going resolve those dependencies and drop in your script and link tags for you.</p>

						<p>Why do we use these? The dependency management is nice, and it keeps us from accidentally loading up some files more than once. It also keeps our template files template-y - focused on layout rather than making sure our scripts and styles are loaded in the right place in the right order from page to page to page. Let's look at some examples.</p>
					</aside>
				</section>
				<section>
					<pre style="width:100%"><code data-trim>
<head>
<link href="<?php echo get_template_directory_uri(); ?>/style.css" rel="stylesheet" type="text/css">
<link href="<?php echo home_url(); ?>/wp-includes/css/dashicons.css" rel="stylesheet" type="text/css">
<script src="<?php echo get_template_directory_uri(); ?>/js/scripts.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>
					</code></pre>
					<aside class="notes">
						<p>Okay, so what's wrong here? First we've linked in our theme's styles, which is probably fine. Next, oh, well looks like we wanted to use WordPress's dashicons on the front end. Hope they don't move those on us. Next we've got our theme's scripts, once again, pretty unremarkable, and finally, ah, yes. We've loaded jQuery from a CDN like everyone tells us to, but there are a couple issues. First issue is our own scripts probably depend on jQuery but we've loaded them out of order. Furthermore, some plugin author is probably going to load WordPress's jQuery, so then we'll have two versions loaded together, which never pans out. Finally, you generally don't need to put your script tags in your header and hold up the rest of the site. That's called render-blocking content.</p>
					</aside>
				</section>
				<section>
					<pre><code style="max-height:none" data-trim>
class Plz {
	function __construct() {
		add_action('wp_enqueue_scripts', [$this, 'wp_enqueue_scripts']);
	}

	function wp_enqueue_scripts() {
		wp_enqueue_script(
			'google-maps',
			'https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap'
		);
		wp_enqueue_script(
			'theme-scripts',
			get_template_directory_uri() .'/js/scripts.js',
			['jquery'],
			filemtime(get_template_directory().'/js/scripts.js'),
			true
		);
		wp_enqueue_style(
			'theme-styles',
			get_template_directory_uri() . '/style.css',
			false,
			filemtime(get_template_directory().'/style.css')
		);
		wp_enqueue_style('dashicons');
	}
}
$plz = new Plz();
</code>
					</pre>
					<aside class="notes">
						<p>So like good PHP programmers, we're going to wrap our functions file or our plugin in a class and not clutter the global namespace. Then we can hook into the wp_enqueue_scripts action with our own function and queue up some stuff. You'll see we give our resource a handle and then a URL. In our second script here you'll see I've included a third argument, which is dependencies. Our theme's scripts depend on jQuery, so WordPress won't load them without jQuery. Then we've got our theme styles, and you can see here I haven't passed any dependencies, but I have passed a function for the write time of the file - this is a fun way to cache-bust your resources. Finally, WordPress also has already registered a handle for dashicons so we can enqueue that by itself. I'll explain registering a bit later.</p>

						<p>Cool, okay, so what other WordPress stuff can we do? I vote we move jQuery to the footer. By default, WordPress sticks it in the header - gross. If your site depends on jQuery for the layout to be right or takes so long to load that the user is going to do something that should fire some jQuery logic before the page is loaded, you’ve got other problems. You might rethink your layout. This is also a great intro to manipulating third-party plugins’ scripts and styles - another handy advantage of these functions. Here’s how we can do that:</p>
					</aside>
				</section>

				<section>

					<pre><code class="data-trim">
wp_deregister_script( 'jquery' );
wp_enqueue_script( 'jquery', includes_url( '/js/jquery/jquery.js' ), false, false, true );
					</code></pre>

					<aside class="notes">
						<p>Once again, WordPress already registers a handle for jQuery. You'll see with jQuery I've actually deregistered WordPress's default handle and re-registered it. The fifth argument is to load the resource in the footer so it isn't render-blocking. Not sure why this isn't default WordPress behavior, but I'd call it best practice. We're using the same file and handle so that when plugin developers enqueue jQuery, it doesn't get enqueued twice.</p>
					</aside>

				</section>

				<section>
					<h2>Enqueueing in Plugins</h2>
					<ul>
						<li>wp_enqueue_script is indiscriminate</li>
						<li>wp_register_script</li>
						<li>Enqueue at entry point</li>
					</ul>
					<aside class="notes">
						<p>Various plugins you install to your site or that you develop are going to need their own scripts and styles. "Yeah! So I’ll just hook into wp_enqueue_scripts() and enqueue my scripts!" Don’t do that, probably.</p>

						<p>By actually enqueuing your scripts on the enqueue scripts action, you're telling WordPress to load that script or style on every single page on the site. This probably isn't necessary. Fortunately, there’s a solution.</p>

						<p>wp_enqueue_script() and wp_enqueue_style() come with a couple of related functions called wp_register_script() and wp_register_style(). These functions take the same arguments as their enqueue counterparts, but don’t actually tell WordPress to spit them out. Instead, it saves them for later, when you can call wp_enqueue_script() using the handle you registered and queues it up then - like dashicons and jQuery earlier. So the way this ends up working is you can register your script and then, at your plugin's entry point, be that a shortcode or a template file or a function call, enqueue the relevant scripts and styles. This prevents your scripts and styles from being loaded on every page, in particular those that your plugin isn't actually acting upon.</p>

						<p>Unfortunately, a lot of plugins don’t do this. I’d like to talk about one in particular that has a lot of the market despite being, in more than just request efficiency, generally really frustrating to work with as a dev. Say hi to NextGen Gallery.</p>
					</aside>
				</section>

				<section>
					<img src="img/nextgen.png">
					<img src="img/kramer.gif">

					<aside class="notes">
						<p>So before you freak out, NextGen actually addressed this issue. According to the changelog, it was February of last year. That being said, this plus some other behavior I'm not super fond of kept me away from NextGen long enough that I wasn't around to hear it was fixed. It's also a great lesson to be learned.</p>

						<p>Here's the story: at the point in time where this was a problem, NextGen loaded about 13 styles and scripts to do some of its basic gallery things. Now even if that's only showing up on one page, that's a lot. But here's the kicker - you could spin up a default WordPress site, base theme, not touch any settings. Install NextGen, don't even set up a gallery or upload photos. If you checked out the network tab on your home page, there were those 13 scripts and styles. On every page. Whew.</p>

						<p>Like I said, they've cleaned it up, which is awesome, and if you peruse the changelog, they've been making a lot of efforts at being performant, which is nifty.</p>

						<p>Here's another, less dramatic example - Contact Form 7. To this day, Contact Form 7 makes 3 requests on every page on your site - 2 scripts, dutifully in the footer, and one stylesheet. Let's go ahead and demo that.</p>
					</aside>

				</section>
				<section>
					<h1>Demo Time</h1>
					<a href="http://contactform7.com/loading-javascript-and-stylesheet-only-when-it-is-necessary/">Clean up Contact Form 7 Scripts and Styles</a>
					<aside class="notes">
						<p>There's even a blog post on the developer's website telling you how to turn it off. I don't know the intricacies of how Contact Form 7 works, but I'd like to think this could be avoided out of the box.</p>
					</aside>
				</section>
				<section>
					<h1>Level 2</h1>
					<h2>Optimization</h2>

					<aside class="notes">
						<p>Thus far, we've talked about ways that WordPress allows us to make sure that the actual task of making a request is done intelligently - only when necessary and without duplication of resources. Now let's see what we can do with our code to make the files themselves more efficient.</p>
					</aside>
				</section>
				<section>
					<h1>CSS Preprocessors</h1>
					<ul>
						<li>Scss, LESS</li>
						<li><a href="https://prepros.io/">PrePros</a>, <a href="https://getcrunch.co/">Crunch</a>, <a href="https://incident57.com/codekit/">CodeKit</a></li>
					</ul>

					<aside class="notes">
						<p>First let's talk about CSS preprocessors. How many people in the room are writing vanilla CSS? Alright, a few of you. Many of you may be familiar with these and just don't care and for others, maybe this is news to you.</p>

						<p>There are a couple of big CSS extension languages out there called LESS and Sass, or SCSS. Neither of them are technically required for using CSS preprocessors, but they sure are nice. They let us declare variables, use imports, nest selectors, define "functions", lots of fun stuff. Explore them if you haven't.</p>

						<p>But the browser can't read any of these extension languages, so we use CSS preprocessors. I'm familiar with a few I've listed here, and your neighbor probably has their favorite. These will compile your scss or your less into browser-friendly CSS. In regards to our talk today, I'm going to talk about two big things we get out of these: concatenation and minification.</p>

						<p>Open WordCamp demo theme</p>

						<p>So here's a pretty basic WordPress theme. I've got a header, footer, index, functions and styles. Really about the bare minimum, you can ignore some of that other stuff for now. Now I can open my styles.css file and you see I've got some basic styles here, and if we open my functions.php file, you'll see I've enqueued it. Let's hop on the front of the site and, sure enough, I've got a pretty straightforward "Hello World". Great.</p>

						<p>How about I want to load up another CSS file? I'm a good dev, I like to keep my code compartmentalized. Atomic design and all that. So I hop into my css folder directory and I've got a new styles.css here. Let's add something silly, like make my background orange, and then go over to functions and enqueue that. Refresh and the background is orange. Well that _works_, but now we're up a request. Yuck. How can we avoid that? Well we can put all our styles in one file, but that becomes unmanageable. How about a CSS extension language?</p>

						<p>For this example, I'm using my extension of choice, scss. I'll hop into my scss directory, set up a new file here and copy over the code from my original stylesheet. Now if you're using a tool like Prepros, you can drag your theme right in here and it's going to automatically find your scss and compile it as soon as we save. Let's go back to our file, save, and sure enough, we get a quick notification that says everything went well. And if we open up our css folder, we see its contents have been replaced with the results of the compilation. Couldn't be much easier. Let's go over to functions and enqueue this sheet instead of the default one. Perfect.</p>

						<p>Now let's get back to compartmentalized code: I want several files, but just one request. Well with scss, that becomes super easy. I can create a new directory here called partials, create a new file, for now we'll call it foo.scss or something, and we can make our background orange right here. Now back in our main styles.css, I can @import my other stylesheet right underneath my other styles. Let's save and refresh, sure enough, we've got an orange background.</p>

						<p>And that scales very very well. I can also configure PrePros to minify my files when it's done so that I end up with the smallest filesize possible. It'll do the same kind of thing for Javascript files, too - concatenation and minification, and compilation if you're using something like CoffeeScript.</p>
				</section>

				<section>
					<h1>Level 3</h1>
					<h2>Task Runners</h2>
					<ul>
						<li>Gulp</li>
						<li>Grunt</li>
					</ul>

					<aside class="notes">
						<p>
							Now personally, I'm not much for these big GUI apps. They do what they do well, but there's a lot more out there you can do with your files of all kinds, and for that, you're going to need something more extensible. The solution is task runners. These have gotten super popular recently. These are command line tools generally based on Node.js, which is like server-side javascript. Gulp and Grunt are the two big ones, and I'm going to give you a quick look at Gulp by getting it configured to do the same stuff that PrePros was doing. This is going to be a super-fast crash course and you should definitely look for tutorials on getting started with this stuff. I'm just here to convince you it's awesome.
						</p>
						<p>
							First, you'll want to set up a package.json that says your project requires gulp. [Explain package.json] It does this via a tool called npm, which stands for node package manager. You can Google that for more information about getting set up.
						</p>
						<p>Next let's check out our gulpfile.js</p>
						<p>
							So gulp operates on the idea of plugins, all of which are also maintained on npm. I'm gone ahead and installed gulp-sass, which will compile our scss for us. Let's go ahead and pause PrePros, wipe our CSS directory to make sure I'm not fooling you, and then from the command line we can run `gulp sass`. Our CSS file is generated and boom, refresh, same result. You can see I've also set up a watch task, so we can have gulp watch for file changes just like PrePros was doing.
						</p>
						<p>
							How about minification? Auto-prefixing? All done via other gulp plugins that I've already installed. I'll go ahead and uncomment the autoprefixer stuff here, save, check out our CSS and our flexbox is set for a variety of browsers. Same for minification.
						</p>
					</aside>
				</section>
				<section>
					<h1>What else can gulp do?</h1>
					<ul>
						<li>Spritesheets</li>
						<li>Prune CSS</li>
						<li>Optimize images</li>
						<li>JavaScript</li>
					</ul>
					<aside class="notes">
						<p>
							Gulp can be extended to do all kinds of stuff with your CSS - create spritesheets, compare against your markup and prune unused selectors, it's awesome. It'll also do your Javascript, minify images - you can do a lot with this thing.
						</p>
						<p>
							Last thing on gulp, I'm going to show you the gulpfile I like to use for production. I've actually further abstracted gulp behind a wonderful library from Laravel called Elixir. Let's open that up and take a look at what it's doing really quickly.
						</p>
					</aside>
				</section>
				<section>
					<h1>CDN vs Self-hosted</h1>
					<aside class="notes">
						<p>
							All right, so the last thing I want to talk about today is CDNs. Raise your hand if you aren't familiar with CDNs. Real quick, a CDN or content-delivery network is a strategy for dispersing commonly-used resources across the world to minimize latency and downtime for delivery. If you've ever used a third-party front-end library, you've probably seen getting started instructions that inclue fetching from a CDN like MaxCDN, Google, there are a bunch. There are a variety of advantages to this strategy.
						<p>
					</aside>
				</section>

				<section>
					<h2>CDN Advantages</h2>
					<ul>
						<li>Server potentially closer to the user</li>
						<li>Potential pre-cache</li>
						<li>One less request in your server's pipeline</li>
						<li>Generally, high uptime</li>
					</ul>
					<aside class="notes">
						<p>CDNs are awesome for a few reasons. The first is that the CDN's location is likely closer to your user and hosted on a pretty kicking server, so the latency is likely to be low.</p>
						<p>
							There's also the advantage that this could be the same resources that a variety of sites around the internet are using, including ones your user has already visited. That means, at least on the first page load, there's a possibility that the file is already cached on the user's browser, which is good news for you. If not, their browser wil cache it after that and hopefully it'll benefit someone else down the line.
						</p>
						<p>
							Remember when we talked about that HTTP pipeline and how you can only have 4 concurrent connections to any one server? With CDNs, you take a request out of your stack and put it in another. Neato.
						</p>
						<p>
							And finally, these are companies that make their money by providing high uptime and low latency across a distributed network, so they do it pretty well.
						</p>
					</aside>
				</section>
				<section>
					<h2>CDN disadvantages</h2>
					<ul>
						<li>Uptime? Who cares?</li>
						<li>I'm lazy and upgrade-happy</li>
						<li>No CSS optimization</li>
						<li>Giving up control</li>
						<li>$</li>
					</ul>
					<aside class="notes">
						<p>
							This all sounds pretty good. Any disadvantages? Some.
						</p>
						<p>
							So first, I don't really care about uptime if the alternative is hosting it myself. If my site is down, it's not going to matter if I can fetch Bootstrap from the CDN, my site is down. If my site is up, I'll be able to fetch my own site from my own server. Similarly, let's say the CDN _did_ go down - now my site may load without the basic CSS framework. If you've been thoughtful about it, this may fall back to something useable, but that's not always true, so now it just looks like your site is broken. Personally, I'd rather all or nothing.
						</p>
						<p>
							Next, I really like to upgrade libraries. If I'm doing work on an existing client site, the first thing I often do is an npm update and get all my front-end libraries up-to-date before building, testing locally and pushing out. I like to think this minimizes bugs and potential security holes, though with front-end libraries that isn't usually a concern. With CDNs, the URL you're hitting is generally versioned, but I don't really care to figure out which version is the latest and then bump all my URLs manually. By the same token, I don't want to use the "latest" URL if the CDN offers it, because then any updates hit the live site without my oversight.
						</p>
						<p>
							CSS optimization. Let's go back to that scss file we were working with earlier. You'll notice here I've commented out a _lot_ of bootstrap rather than just @include bootstrap. I often only use the grid - some of this stuff I never comment out on any sites I work on. This makes sure my CSS is only as big as it needs to be. With a CDN, it's all or nothing. Now a lot of libraries only have one file, so it really doesn't make a difference like it does here with Bootstrap or other CSS frameworks.
						</p>
						<p>
							Giving up control. While unlikely, there's a possibility that your CDN is compromised or goes rouge or whatever and suddenly you're served up alternative or even malicious files. Or maybe they're collecting referrer information and using it to track your users? The former is unlikely and the latter is a small drop in a pool of questionable big data practices, but if it's something you're worried about, a CDN probably isn't for you. A tinfoil hat, however, might be.
						</p>
						<p>
							Finally, if you're looking to host your own resources on a CDN, that's going to cost money. If that's something you or your client have budgeted for, great, and if not, this may not be an option.
						</p>
						<p>
							As with most of the stuff I've talked about today, use your best judgement. A CDN is great for some situations and not so much for others. To be honest, Google Fonts and Typekit are the only two that I regularly use, as I prefer to bundle all my resources together for a single request in most other situations.
						</p>
					</aside>
				</section>
				<section>
					<h2>In Review</h2>
					<ul>
						<li>Enqueue your requests, and enqueue them conditionally</li>
						<li>Make fewer requests</li>
						<li>Optimize your resources</li>
						<li>Task runners are your friend</li>
						<li>Consider a CDN</li>
					</ul>
					<aside class="notes">
						And that about wraps it up. Let's review real quickly what we went over today: [blah]. Any questions?
					</aside>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'socket.io/socket.io.js', async: true },
        	{ src: 'plugin/notes-server/client.js', async: true },
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
